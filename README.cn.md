**Read this in English: [English](README.md)**  

# 🏦 OutStake -- 完全围绕原生收益构建

_不仅仅是原生收益质押协议_

**Outstake** 是一个完全围绕原生收益代币构建的的协议，我们首个提出了一种与原生收益率挂钩的非美元稳定币模型，相比于目前市场上的其他收益代币协议（如 **Pendle**）更加灵活，可组合性更强，同时为提供了更高的收益率以及多种收益来源。**Outstake**支持的资产构成了 **Outrun** 生态系统的基础支撑，为整个生态系统提供了稳定的基础。 具体而言，**Outstake**的工作原理如下：

1. **基于原生收益代币的全新质押模型**：采用了不同于市场的全新设计**，**允许用户控制其资产产生的原生收益。通过 **Outstake** 可以铸造质押代币 **PT** 以解锁其质押资产的流动性，并在一系列 **DeFi** 应用程序中使用它们。
2. **原生收益稳定币（也是一种 YT）**：原生收益稳定币的价值与原生收益率直接挂钩。围绕它构建的经济模型为质押者提供了更高的收入和多种收入来源。它具有高度可组合性，允许开发人员围绕它创建新产品，从而丰富 **Outrun** 生态系统。
3. **仓位期权代币**：该期权代币代表原生收益代币的**锁定期到期赎回权**，通过该期权可以在不交易 **PT** 本身的情况下交易获得固定利率的权利，从而提高资本效率。

## 质押 Rebase 原生收益代币

**Rebase 原生收益代币**是指需要手动领取原生收益或者自动 **Rebase** 的原生收益代币，例如 **Blast ETH**, **Lido stETH**。

对于质押 **Rebase 原生收益代币**，**Outrun** 生态系统会铸造三种 **ERC20** 代币:

* 原生收益代币包装代币 **(WT)** 作为对 **Rebase 原生收益代币**的包装代币
* 质押本金代币 **(PT)**，到期可燃烧 **PT** 赎回质押的全部 **WT**。
* 质押收益代币 **(YT)**，与该**原生收益代币**的原生收益率挂钩，随时可以赎回。

### 原生收益代币包装代币 WT

**WT** 是一种与 **Rebase 原生收益代币**挂钩的稳定币，可以通过 1 : 1 的包装获得。

因此 1 个 **WT** 始终代表 1 个 **Rebase 原生收益代币**，并且 **WT** 在流通中的数量与其对应的 **Rebase 原生收益代币**数量相匹配，用户随时可以将 **WT** 转换为 **Rebase 原生收益代币**。单独持有 **WT** 并不会获得质押产生的原生收益的，应该将其视为持有 **Rebase 原生收益代币** 的类比。

在 **Blast L2** 中，**orETH (WT)** 同时会作为在 **Outswap** 中的 **Wrapped ETH**.

### 质押本金代币 PT

**PT** 是质押 **WT** 而铸造的质押本金代币，旨在释放质押代币的流动性。

用户质押 **WT** 时需要指定一个锁定时间从而铸造 **PT** 与 **YT**，**PT** 数量并不是按质押的 **WT** 来 1 : 1 铸造的，而是与质押的时间相关，或者说与铸造的 **YT** 数量相关，**Rebase 原生收益代币**的数量等于可转换的**原生代币的数量 (Native token amount)**，具体算法为：

<p align="center">
  <img src="./assets/PTAmount.png" alt="">
</p>

**YT redeemable value**（YT 可兑现价值）：销毁一个 YT 能赎回的原生收益。

随着时间的推移，金库中不断产生原生质押收益，相应数量的 **WT** 被铸造并添加到 **YieldPool** 中，从而提升 **YT** 可兑现价值，新质押的 **WT** 所铸造的 **PT** 会略微减少，但无论所铸造的 **PT** 数量是多少，锁定时间到期后，用户都能销毁当时铸造的 **PT** 将自己的质押的 **WT** 完全赎回。

## 质押非 Rebase 原生收益代币

**非 Rebase 原生收益代币**的原生收益内置于原生收益代币本身，燃烧**非 Rebase 原生收益代币**可以同时赎回本金以及原生收益。例如 **slisBNB (Lista),  STONE (Stakestone)**。

对于质押**非 Rebase 原生收益代币**，**Outrun** 生态系统会铸造两种 **ERC20** 代币:

* 质押本金代币 **(PT)**，到期可以燃烧 **PT** 赎回质押的**非 Rebase 原生收益代币**的本金部分。
* 质押收益代币 **(YT)**，与该原生收益代币的原生收益率挂钩，随时可以赎回。

### 质押本金代币 PT

**PT** 是通过质押**原生收益代币**并指定锁定时间获得。

对于**非 Rebase 原生收益代币，PT** 数量也不是按质押的**原生收益代币** 1 : 1 铸造的，而是与质押的时间（铸造的 **YT** 数量）以及**非 Rebase 原生收益代币**相对于**原生代币**的赎回比率相关，简单讲，先将**非 Rebase 原生收益代币**的数量转换为对应的**原生代币**的数量，然后再使用以下算法计算：

<p align="center">
  <img src="./assets/PTAmount.png" alt="">
</p>

**YT redeemable value**（**YT** 可兑现价值）：销毁一个 YT 能赎回的原生收益。

**需要注意的是**: 由于质押的代币是**非 Rebase 原生收益代币**，而在锁定时间到期后**非 Rebase 原生收益代币**的数量不会发生改变，但是其价值（相对于**原生代币**的赎回比率）会随原生收益的积累增长，所以燃烧 **PT** 并不会赎回和最初质押时相同数量的**非 Rebase 原生收益代币，而是会略微减少，因为其中一部分价值归属于 YT。**

## 质押收益代币 YT

**YT** 代表对质押的**原生收益代币**的收益权，通过质押**原生收益代币**并指定一个锁定时间获得。**YT** 将**原生收益代币**的原生收益单独剥离出来，**YT** 可以在二级市场上交易以及用于构建其他 **DeFi** 乐高。

### **真正的通用同质化 YieldToken**

与目前市场上其他协议的 **YieldToken** 不同，其他协议的 **YieldToken** 都是 **NFT 或者特殊的 FT** **(Pendle)**，他们都是非同质化的，这种特性导致了 **YieldToken 流动性缺失**，并且**降低了协议的可组合性**。

**Outrun** 的 **YT** 是**真正的同质化 Token (FT)**，**流动性非常好，可组合性极强**。每将 1 个**原生收益代币**锁定质押 1 天会铸造 1 个 **YT**，将 _x_ 个 **原生收益代币**锁定质押 _y_ 天就会铸造 _xy_ 个 **YT**，所以理论上 1 个**YT** 锚定 1 个**原生收益代币** 1 天所产生的原生收益。

**YT** 可以自由交易，并且可以无限制地即时销毁并赎回 **YieldPool** 中积累的原生收益，销毁时按销毁的 **YT** 数量占 **YT** 总量的比例赎回已产生原生收益。

### **YT 的稳定机制**

**YT** 同时也是一种与**原生收益率**挂钩的**非美元算法稳定币**，理论上 1 个 **YT** 代表 1 个**原生收益代币** 1 天所产生的原生收益。由于 **YT** 与**原生收益率**挂钩，并且也是由**原生收益代币**质押所铸造的，不同于早期 **Luna** 这类算法稳定币，**YT** 的价值系统是一个封闭的系统，**永远不会出现价格死亡螺旋**的情况

在最初时，**YT** 的可兑现价值（销毁 **YT** 赎回的原生收益）在从第一个 **YT** 被铸造后会随着时间缓慢增长，理论上在达到理论价值上限时会停止增长。而燃烧 **YT** 会等比例赎回原生收益，所以不会影响其可兑现价值。**YT 的可兑现价值只会在铸造新的 YT 时降低**，并且降低多少在未来就会重新积累多少（因为质押了新的**原生收益代币**）。

然而在实际运行中，会有部分用户在其质押的**原生收益代币**锁定时间未到期时提前燃烧 **YT**，导致 **YT** 的流通量减少，而 **YieldPool** 中仍然在积累原生收益，**最终导致 YT 的可兑现价值突破理论价值上限**，这种情况会导致后续出现两种可能性：

1. **套利机会**：**PT** 的市场价格高于**原生代币**时，用户可以质押更多**原生收益代币**以铸造新的 **YT** 并立即燃烧完成套利，但是这会为下一次价值突破提供更多燃料。
2. **长期质押者的的原生收益增加：YT** 能赎回的收益更多，同时受套利者的影响，**PT** 的市场价格会略微降低（但是 **PT** 的流通量本身就低于的质押量，并且受到 **FFLaunch** 与 **Memeverse** 影响）

所以 **YT** 的可兑现价值突破理论价值上限的过程会**不断重现**，从而实现**增长飞轮**，带来更多的质押量。而由 **YT** 而构建的经济模型会 **Outrun** 生态系统带来更多的机会。

### **更广阔的前景**

**YT** 不仅仅是帮助长期质押者获得更多收益的工具，它是一个真正的**通用同质化 Yield Token**，同时也是 **Web3 第一个锚定原生收益率的去中心化算法稳定币**，在市场的博弈下 **YT** 始终与**原生收益率**挂钩，在未来 **Outrun** 会依托 **YT** 的特性和社区一起构建更多有意思的产品。

### 数学模型

**YT** 的机制虽然看起来很简洁，但是由于 **YT** 可以自由交易，并且任何持有 **YT** 的用户可以随时赎回原生收益，所以这其中会有一个非常复杂的博弈过程，从而引入一个极其复杂的数学模型。

下面我们构建一个最小的模型来计算无常损失。

假设 **YieldPool** 中此时的积累的原生收益为 0，我们将 1 个 **YT** 锚定的 1 个**原生收益代币** 1 天所产生的原生收益设为 _**y**_。用户 _**A**_ 质押了 _**a**_ 个**原生收益代币**并锁定 _**m**_ 天，这会铸造 _**am**_ 个 **YT**，我们将此时其他用户看成一个整体，这个整体看作用户 _**B**_ 质押了 _**b**_ 个**原生收益代币**并锁定 _**n**_ 天，这会铸造 _**bn**_ 个 **YT**。

在 _**t**_ 天之后

<p align="center">
  <img src="./assets/Profit.jpg" alt="" width="563">
</p>

用实际收益除以预期收益再减 1 可以得出无常盈亏率 **(IPnLR)**\
_**IPnLR**_** = (Actual Earnings / Expected Earnings) - 1**

<p align="center">
  <img src="./assets/IPnLR.jpg" alt="" width="342">
</p>

再用 _**IPnLR**_ 乘以各自的实际收益 _**aty**_ 与 _**bty**_ 可得各自的无常盈亏 _**IPnL**_\
_**IPnLa = IPnLRa \* Expected Profit\_A**_\
_**IPnLb = IPnLRb \* Expected Profit\_B**_

<p align="center">
  <img src="./assets/IPnL.jpg" alt="" width="375">
</p>

从上图可以得出，用户 **A** 的与用户 **B** 的无常盈亏守恒，如果用户 **A** 与 **B** 锁定的时间相同，则双方都没有无常盈亏。也就是说一个用户的无常盈亏和质押池中其他用户的加权平均天数相关。

当然上面只是一个最小化模型，实际情况受到多方博弈的影响会更加复杂。所以我们会设定一个最长锁定时间限制 **MaxLockInterval**，用户锁定时间越靠近 **MaxLockInterval**，用户的 _**IL**_ 越小, _**IP**_ 越大，除此之外用户还可以通过在锁定时间到期时，立即赎回本金然后再质押铸造 **YT** 来减少 _**IL**_，获取更多 _**IP**_，当用户锁定时间为 **MaxLockInterval** 时一定不会有 _**IL**_ 。

通过上面的模型，**Outrun** 可以帮助长期质押者获得更多收益。我们认为**原生代币**质押本身致力于使**原生代币**背后的生态系统更去中心化与更安全，所以长期保护生态系统的用户更应该获得更多的奖励。

## Position Options Token

**Position Token** 是代表仓位的 **Token**，用户在质押锁定原生收益资产时除了会铸造 **PT** 与 **YT** 以外，还会铸造 **Position Token** 代表用户的仓位。

由于 **Position Token** 可交易的特性，因此也可以将其视为一种**期权**，该 **Token** 代表原生收益代币的锁定时间到期赎回权，我们将其称之为 **Position Options Token**。

**Position Options Token** 允许持有者在未来，也就是**仓位锁定时间到期时**，销毁固定数量的 **PT** 赎回固定数量的原生收益资产，通过它可以**交易获得固定利率的权利**，而无需交易 **PT** 本身。

**Position Options Token** 由 **ERC1155** 标准支持，将单个仓位分割为多份，允许用户交易仓位的部分赎回权利。

此外 **Position Options Token** 的持有者还可以选择强制赎回提前赎回质押的原生资产，强制赎回需要销毁与提前时间相关数量的 **YT**，并且会收取少量的手续费。

## Outstake 与 Pendle 的区别

目前市场上最热门原生收益质押协议是 **Pendle**，因此我们对比 **Outstake** 与 **Pendle** 的区别，看看 **Oustake** 有什么优势，解决了什么问题。

1. **代币类型和可组合性**:
   * **Pendle**: 铸造的 **PT (Principal Token)** 和 **YT (Yield Token)** 具有到期时间。**PT** 和 **YT** 并非通用的 **ERC20** 代币，而是更接近于 **NFT (不可替代代币)**。这限制了 **Pendle** 上资产的可组合性和使用场景。尤其是 **YT**，其价值会在到期时归零，这进一步限制了它的使用。
   * **Outstake**: 铸造的 **PT** 和 **YT** 是通用的 **ERC20** 代币，没有过期时间，可以在任何去中心化交易所 **(DEX)** 交易，并且可以自由集成到其他 **DeFi** 协议中。这种设计提高了可组合性和灵活性。此外，**Outstake** 的 **YT** 可以被视为与收益率挂钩的稳定币，允许用户对收益率进行多空操作。
2. **固定利率收益**:
   * **Pendle**: **PT** 的铸造数量与质押的代币数量相等，且 **PT** 存在随时间递减的负溢价，而固定利率收益正是来源于 **PT** 的负溢价，即质押用户的亏损。同时要想获得固定利率，用户需购买相应的 **PT**。由于 **PT** 的负溢价，导致质押者提前卖掉 **PT** 时会产生亏损，因此 **PT** 本身的实用价值大大降低，很难集成到其他 **DeFi** 玩法中。
   * **Outstake**: **PT** 的铸造数量与用户铸造的 **YT** 数量和 **YT** 的可兑现价值相关，这避免了 **PT** 产生负溢价。**Outstake** 通过引入可交易的 **Position Options Token (POT)**，即原生收益代币的锁定期到期赎回权，使得用户在不交易 **PT** 的情况下即可获得固定利率的权利，提高了资本效率，而其收益来源于用户的需求交换，并非质押的亏损。
3. **质押时间**:
   * **Pendle**: 质押时间由协议确定，用户无法自由选择质押时间。
   * **Outstake**: 用户可以自由选择质押时间，从而控制 **PT** 的铸造数量。同时，质押的时间被抽象为 **POT**，使得仓位过期时间成为可交易资产，进一步增加了灵活性。
4. **收益来源**:
   * **Pendle**: **Pendle** 并没有产生真实的外部收益，其固定利率收益本质上来自于质押用户的亏损。之前**Pendle** 的高固定利率收益也是因为各种 **Restaking** 等协议的空投积分，让用户甘愿去承担亏损而去博取空投积分而造就的高固定收益，仅仅是昙花一现。
   * **Outstake**: 通过 **Outrun** 生态系统，支持多种资产，创造了丰富的套利市场和多种收入来源。用户除了了能获得原生收益以外，还可以通过交易 **POT** 获取固定利率收益，以及基于 **Outstake** 资产的大量套利机会，增强了协议的整体收益性与可扩展性。

## 闪电贷

**FlashLoan** 闪电贷是一种在区块链上借入资产的新方式。与传统的担保贷款不同，闪电贷不需要任何抵押品、信用评分或管理来处理无担保贷款。**FlashLoan** 经常被用于链上套利，清算等活动。

**FlashLoan** 利用原子性允许用户在不提供抵押品的情况下借款。有两个注意事项需要提及。首先，无论何时你在闪电贷中借入资产，你都必须支付使用手续费用。其次，必须在借款的同一笔交易中偿还贷款。

**Outstake** 提供闪电贷功能，套利者可以通过提供的接口使用该功能，借出用户质押的原生收益代币，并在同一笔交易中归还。这样可以为质押者的提供更多的收益来源，提高资本利用率。

## 为什么选择 Outstake?

1. **全新质押模型**

* **Outstake** 提出了基于原生收益代币的新质押模型，允许用户自主控制其资产所产生的原生收益。
* 用户可以铸造 **PT**，以释放质押资产的流动性，并将其用于各种 **DeFi** 应用程序中。

2. **创新的稳定币机制**

* **Outstake** 设计了一种全新的与收益率挂钩的非美元算法稳定币。
* 通过围绕该稳定币构建的经济模型，为质押者带来了比传统 **LSD** 协议和收益代币协议更高的收入和多种收入来源。

3. **强大的可组合性**

* **Outrun** 的 **YT** 具有极高的可组合性，允许开发者基于 **YT** 构建新的产品，从而丰富 **Outrun** 生态系统。

4. **Position Options Token（POT）**

* **POT** 代表原生收益代币的锁定时间到期赎回权，通过 **POT** 可以交易固定利率的权利，无需直接交易 **PT** 本身，从而提高了资本效率。

5. **闪电贷功能**

* **Outstake** 提供了闪电贷功能，为原生收益带币质押者带来更高的收益潜力。
